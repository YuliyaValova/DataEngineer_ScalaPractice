package load
import connection.{DB2Connector, DB2ConnectorFromEnv}
import generator.RecordsGenerator
import generator.impl.RecordsGeneratorImpl
import load.impl.DataLoaderImpl

case object LoadStarter{

  /**
   * Entry point of the program. This app creates a table in DB2 on Cloud with 20k sample records.
   * product_id - autogenerated numeric
   * product_group - autogenerated numeric in 0..9 range
   * year - autogenerated numeric in 2015..2018 range
   * 12 columns with monthly purchases amount - numeric in 0..100000 range
   * There should be no duplicates for the same product/year
   * If there are multiple product rows for different years, product/group combination should be concise
   */

  def main(args: Array[String]): Unit = {

    val connection = DB2ConnectorFromEnv.getConnectionToDatabase()
    val generator:RecordsGenerator = new RecordsGeneratorImpl
    val loader = new DataLoaderImpl
    //loader.dropTable(connection,"Sales_test")
    generator.generateTable("Sales_test", connection, 20000)
    DB2Connector.retrieveConnection(connection)
  }
}
